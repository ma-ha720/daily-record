<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥ã€…ã®è¨˜éŒ²ã‚¢ãƒ—ãƒª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .radio-emoji {
            display: inline-block;
            padding: 6px 10px;
            margin: 3px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 14px;
        }
        
        .radio-emoji:hover {
            transform: scale(1.05);
            border-color: #3b82f6;
        }
        
        .radio-emoji input[type="radio"] {
            display: none;
        }
        
        .radio-emoji input[type="radio"]:checked + label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .checkbox-tag {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 14px;
        }
        
        .checkbox-tag:hover {
            transform: scale(1.05);
            border-color: #3b82f6;
        }
        
        .checkbox-tag input[type="checkbox"] {
            display: none;
        }
        
        .checkbox-tag input[type="checkbox"]:checked + label {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-color: #f093fb;
        }
        
        .mode-button {
            padding: 15px 30px;
            border-radius: 25px;
            border: 3px solid #e0e0e0;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            font-weight: bold;
        }
        
        .mode-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .mode-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border-radius: 25px;
            border: none;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #4b5563;
            padding: 15px 40px;
            border-radius: 25px;
            border: none;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        textarea, input[type="date"] {
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            transition: all 0.3s ease;
        }
        
        textarea:focus, input[type="date"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .nav-button {
            padding: 12px 24px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .nav-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .nav-button:not(.active) {
            background: white;
            color: #6b7280;
        }
        
        .nav-button:not(.active):hover {
            background: #f3f4f6;
        }
        
        .record-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .record-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-simple {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }
        
        .badge-detailed {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>
<body class="min-h-screen py-8">
    <div class="container mx-auto px-4 max-w-4xl">
        
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="text-center mb-8 fade-in">
            <h1 class="text-4xl font-bold mb-2" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                æ—¥ã€…ã®è¨˜éŒ² ğŸ“
            </h1>
            <p class="text-gray-600">ãŠå­ã•ã‚“ã¨ã®æ—¥ã€…ã‚’å„ªã—ãè¨˜éŒ²ã—ã¾ã—ã‚‡ã†</p>
        </header>

        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <nav class="mb-6 flex gap-3 flex-wrap justify-center">
            <button onclick="showSection('record')" id="btn-record" class="nav-button active">
                è¨˜éŒ²ã™ã‚‹
            </button>
            <button onclick="showSection('list')" id="btn-list" class="nav-button">
                è¨˜éŒ²ä¸€è¦§
            </button>
            <button onclick="showSection('dashboard')" id="btn-dashboard" class="nav-button">
                ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
            </button>
            <button onclick="showSection('export')" id="btn-export" class="nav-button">
                ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            </button>
        </nav>

        <!-- è¨˜éŒ²ä½œæˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="section-record" class="card p-8 fade-in">
            <h2 class="text-2xl font-bold mb-6 text-center">âœ¨ ä»Šæ—¥ã®è¨˜éŒ²</h2>
            
            <!-- ãƒ¢ãƒ¼ãƒ‰é¸æŠ -->
            <div class="mb-8 text-center">
                <p class="text-gray-600 mb-4">è¨˜éŒ²ã®æ–¹æ³•ã‚’é¸ã‚“ã§ãã ã•ã„</p>
                <div class="flex gap-4 justify-center flex-wrap">
                    <button type="button" onclick="setRecordMode('simple')" id="mode-simple" class="mode-button active">
                        ğŸ˜Š ç°¡æ˜“è¨˜éŒ²
                    </button>
                    <button type="button" onclick="setRecordMode('detailed')" id="mode-detailed" class="mode-button">
                        ğŸ“ è©³ç´°è¨˜éŒ²
                    </button>
                </div>
            </div>

            <!-- è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒ  -->
            <form id="recordForm" onsubmit="saveRecord(event)">
                
                <!-- æ—¥ä»˜ -->
                <div class="mb-6">
                    <label class="block text-lg font-semibold mb-2">ğŸ“… æ—¥ä»˜</label>
                    <input type="date" id="recordDate" required class="w-full text-lg">
                </div>

                <!-- ç°¡æ˜“è¨˜éŒ²ãƒ¢ãƒ¼ãƒ‰ -->
                <div id="simple-mode-fields">
                    <!-- å­ã©ã‚‚ã®æ§˜å­ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ˜Š å­ã©ã‚‚ã®æ§˜å­</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="childMood" value="â—" id="child-excellent">
                                <label for="child-excellent" class="cursor-pointer px-2 py-1 block">â— ã¨ã¦ã‚‚è‰¯ã„</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMood" value="â—‹" id="child-good">
                                <label for="child-good" class="cursor-pointer px-2 py-1 block">â—‹ è‰¯ã„</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMood" value="â–³" id="child-fair">
                                <label for="child-fair" class="cursor-pointer px-2 py-1 block">â–³ æ™®é€š</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMood" value="Ã—" id="child-bad">
                                <label for="child-bad" class="cursor-pointer px-2 py-1 block">Ã— è‰¯ããªã„</label>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚ãªãŸã®ä½™è£• -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ’ª ã‚ãªãŸã®ä½™è£•</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacity" value="â—" id="parent-excellent">
                                <label for="parent-excellent" class="cursor-pointer px-2 py-1 block">â— ä½™è£•ã‚ã‚Š</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacity" value="â—‹" id="parent-good">
                                <label for="parent-good" class="cursor-pointer px-2 py-1 block">â—‹ ã¾ã‚ã¾ã‚</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacity" value="â–³" id="parent-fair">
                                <label for="parent-fair" class="cursor-pointer px-2 py-1 block">â–³ å°‘ã—ç–²ã‚Œ</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacity" value="Ã—" id="parent-bad">
                                <label for="parent-bad" class="cursor-pointer px-2 py-1 block">Ã— ã‹ãªã‚Šç–²ã‚Œ</label>
                            </div>
                        </div>
                    </div>

                    <!-- å¯¾å¿œã®çµæœ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ“Œ å¯¾å¿œã®çµæœ</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="responseResult" value="ã†ã¾ãå¯¾å¿œã§ããŸ" id="response-good">
                                <label for="response-good" class="cursor-pointer px-2 py-1 block">âœ¨ ã†ã¾ãå¯¾å¿œã§ããŸ</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="responseResult" value="ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ" id="response-bad">
                                <label for="response-bad" class="cursor-pointer px-2 py-1 block">ğŸ˜¢ ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ</label>
                            </div>
                        </div>
                    </div>

                    <!-- ä½•ãŒã‚ã£ãŸï¼Ÿ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ” ä½•ãŒã‚ã£ãŸï¼Ÿï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ç™»æ ¡é–¢ä¿‚" id="tag-school">
                                <label for="tag-school" class="cursor-pointer px-2 py-1 block">ğŸ« ç™»æ ¡é–¢ä¿‚</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ç™‡ç™ªãƒ»ãƒ‘ãƒ‹ãƒƒã‚¯ãƒ»å›é¿è¡Œå‹•" id="tag-panic">
                                <label for="tag-panic" class="cursor-pointer px-2 py-1 block">ğŸ’¥ ç™‡ç™ªãƒ»ãƒ‘ãƒ‹ãƒƒã‚¯</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ãã‚‡ã†ã ã„é–¢ä¿‚" id="tag-sibling">
                                <label for="tag-sibling" class="cursor-pointer px-2 py-1 block">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ãã‚‡ã†ã ã„é–¢ä¿‚</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="å­¦ç¿’" id="tag-study">
                                <label for="tag-study" class="cursor-pointer px-2 py-1 block">ğŸ“š å­¦ç¿’</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="å¤–å‡º" id="tag-outing">
                                <label for="tag-outing" class="cursor-pointer px-2 py-1 block">ğŸš¶ å¤–å‡º</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ãã®ä»–" id="tag-other-simple">
                                <label for="tag-other-simple" class="cursor-pointer px-2 py-1 block">ğŸ“Œ ãã®ä»–</label>
                            </div>
                        </div>
                    </div>

                    <!-- ä¸€è¨€ãƒ¡ãƒ¢ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-2">âœï¸ ä¸€è¨€ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label>
                        <textarea id="simpleNote" rows="3" placeholder="ä¾‹ï¼šåˆå‰ä¸­ã ã‘ç™»æ ¡ã§ãã¾ã—ãŸ" class="w-full"></textarea>
                    </div>
                </div>

                <!-- è©³ç´°è¨˜éŒ²ãƒ¢ãƒ¼ãƒ‰ -->
                <div id="detailed-mode-fields" style="display: none;">
                    <!-- å­ã©ã‚‚ã®æ§˜å­ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ˜Š å­ã©ã‚‚ã®æ§˜å­</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="childMoodDetailed" value="â—" id="child-excellent-d">
                                <label for="child-excellent-d" class="cursor-pointer px-2 py-1 block">â— ã¨ã¦ã‚‚è‰¯ã„</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMoodDetailed" value="â—‹" id="child-good-d">
                                <label for="child-good-d" class="cursor-pointer px-2 py-1 block">â—‹ è‰¯ã„</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMoodDetailed" value="â–³" id="child-fair-d">
                                <label for="child-fair-d" class="cursor-pointer px-2 py-1 block">â–³ æ™®é€š</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="childMoodDetailed" value="Ã—" id="child-bad-d">
                                <label for="child-bad-d" class="cursor-pointer px-2 py-1 block">Ã— è‰¯ããªã„</label>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚ãªãŸã®ä½™è£• -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ’ª ã‚ãªãŸã®ä½™è£•</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacityDetailed" value="â—" id="parent-excellent-d">
                                <label for="parent-excellent-d" class="cursor-pointer px-2 py-1 block">â— ä½™è£•ã‚ã‚Š</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacityDetailed" value="â—‹" id="parent-good-d">
                                <label for="parent-good-d" class="cursor-pointer px-2 py-1 block">â—‹ ã¾ã‚ã¾ã‚</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacityDetailed" value="â–³" id="parent-fair-d">
                                <label for="parent-fair-d" class="cursor-pointer px-2 py-1 block">â–³ å°‘ã—ç–²ã‚Œ</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="parentCapacityDetailed" value="Ã—" id="parent-bad-d">
                                <label for="parent-bad-d" class="cursor-pointer px-2 py-1 block">Ã— ã‹ãªã‚Šç–²ã‚Œ</label>
                            </div>
                        </div>
                    </div>

                    <!-- å¯¾å¿œã®çµæœ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ“Œ å¯¾å¿œã®çµæœ</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="radio-emoji">
                                <input type="radio" name="responseResultDetailed" value="ã†ã¾ãå¯¾å¿œã§ããŸ" id="response-good-d">
                                <label for="response-good-d" class="cursor-pointer px-2 py-1 block">âœ¨ ã†ã¾ãå¯¾å¿œã§ããŸ</label>
                            </div>
                            <div class="radio-emoji">
                                <input type="radio" name="responseResultDetailed" value="ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ" id="response-bad-d">
                                <label for="response-bad-d" class="cursor-pointer px-2 py-1 block">ğŸ˜¢ ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ</label>
                            </div>
                        </div>
                    </div>

                    <!-- ä»Šæ—¥ã®å‡ºæ¥äº‹ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-2">ğŸ“ ä»Šæ—¥ã®å‡ºæ¥äº‹</label>
                        <textarea id="detailedEvent" rows="5" placeholder="ä¾‹ï¼šæœ7æ™‚ã«èµ·ã“ã™ã¨ã€ã„ã¤ã‚‚ã‚ˆã‚Šè½ã¡ç€ã„ãŸæ§˜å­ã§èµ·ãã¦ããŸã€‚..." class="w-full"></textarea>
                    </div>

                    <!-- æ°—ã¥ããƒ»ãƒ¡ãƒ¢ -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-2">ğŸ’¡ æ°—ã¥ããƒ»ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label>
                        <textarea id="detailedInsight" rows="3" placeholder="ä¾‹ï¼šå‰æ—¥ã«äºˆå®šã‚’ä¼ãˆã¦ãŠã„ãŸã“ã¨ãŒè‰¯ã‹ã£ãŸã®ã‹ã‚‚ã—ã‚Œãªã„" class="w-full"></textarea>
                    </div>

                    <!-- ã‚¿ã‚° -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold mb-3">ğŸ·ï¸ ã‚¿ã‚°ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
                        <div class="flex gap-2 flex-wrap">
                            <div class="checkbox-tag">
                                <input type="checkbox" value="å­¦æ ¡é–¢ä¿‚" id="tag-school-d">
                                <label for="tag-school-d" class="cursor-pointer px-2 py-1 block">ğŸ« å­¦æ ¡é–¢ä¿‚</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ä½“èª¿é¢" id="tag-health">
                                <label for="tag-health" class="cursor-pointer px-2 py-1 block">ğŸ¥ ä½“èª¿é¢</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="å¯¾äººé–¢ä¿‚" id="tag-relationship">
                                <label for="tag-relationship" class="cursor-pointer px-2 py-1 block">ğŸ‘¥ å¯¾äººé–¢ä¿‚</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="å®¶æ—" id="tag-family">
                                <label for="tag-family" class="cursor-pointer px-2 py-1 block">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶æ—</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="é€²æ—" id="tag-progress">
                                <label for="tag-progress" class="cursor-pointer px-2 py-1 block">ğŸ“ˆ é€²æ—</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="åœæ»" id="tag-stagnation">
                                <label for="tag-stagnation" class="cursor-pointer px-2 py-1 block">ğŸ“‰ åœæ»</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ãƒˆãƒ©ãƒ–ãƒ«" id="tag-trouble">
                                <label for="tag-trouble" class="cursor-pointer px-2 py-1 block">âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«</label>
                            </div>
                            <div class="checkbox-tag">
                                <input type="checkbox" value="ç™‚è‚²æ”¾ãƒ‡ã‚¤ç­‰" id="tag-therapy">
                                <label for="tag-therapy" class="cursor-pointer px-2 py-1 block">ğŸ¢ ç™‚è‚²æ”¾ãƒ‡ã‚¤ç­‰</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä¿å­˜ãƒœã‚¿ãƒ³ -->
                <div class="flex gap-4 justify-center mt-8">
                    <button type="submit" class="btn-primary">
                        ğŸ’¾ ä¿å­˜ã™ã‚‹
                    </button>
                    <button type="button" onclick="clearForm()" class="btn-secondary">
                        ğŸ”„ ã‚¯ãƒªã‚¢
                    </button>
                </div>
            </form>
        </section>

        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="section-dashboard" class="card p-8" style="display: none;">
            <h2 class="text-2xl font-bold mb-6 text-center">ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            
            <!-- çµ±è¨ˆæƒ…å ± -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="p-6 rounded-2xl text-center" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                    <div class="text-sm text-gray-700 mb-1">ç·è¨˜éŒ²æ•°</div>
                    <div class="text-4xl font-bold" id="stat-total">0</div>
                </div>
                <div class="p-6 rounded-2xl text-center" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                    <div class="text-sm text-gray-700 mb-1">éå»7æ—¥é–“</div>
                    <div class="text-4xl font-bold" id="stat-week">0</div>
                </div>
                <div class="p-6 rounded-2xl text-center" style="background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);">
                    <div class="text-sm text-gray-700 mb-1">ä»Šæœˆ</div>
                    <div class="text-4xl font-bold" id="stat-month">0</div>
                </div>
            </div>

            <!-- ãƒ¢ãƒ¼ãƒ‰åˆ¥çµ±è¨ˆ -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-3">è¨˜éŒ²ã‚¿ã‚¤ãƒ—åˆ¥</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-4 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100">
                        <div class="text-sm text-gray-700">ğŸ˜Š ç°¡æ˜“è¨˜éŒ²</div>
                        <div class="text-3xl font-bold text-blue-600" id="stat-simple">0</div>
                    </div>
                    <div class="p-4 rounded-xl bg-gradient-to-r from-purple-50 to-purple-100">
                        <div class="text-sm text-gray-700">ğŸ“ è©³ç´°è¨˜éŒ²</div>
                        <div class="text-3xl font-bold text-purple-600" id="stat-detailed">0</div>
                    </div>
                </div>
            </div>

            <!-- æœ€è¿‘ã®è¨˜éŒ² -->
            <div>
                <h3 class="text-lg font-semibold mb-3" id="recent-title">æœ€è¿‘ã®è¨˜éŒ²</h3>
                <div id="recentRecords" class="space-y-3">
                    <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
                </div>
            </div>
        </section>

        <!-- è¨˜éŒ²ä¸€è¦§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="section-list" class="card p-8" style="display: none;">
            <h2 class="text-2xl font-bold mb-6 text-center">ğŸ“‹ è¨˜éŒ²ä¸€è¦§</h2>
            
            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="mb-4 flex gap-3 flex-wrap justify-center">
                <select id="filterMode" onchange="renderRecordList()" class="px-4 py-2 border-2 border-gray-200 rounded-xl">
                    <option value="all">ã™ã¹ã¦</option>
                    <option value="simple">ç°¡æ˜“è¨˜éŒ²ã®ã¿</option>
                    <option value="detailed">è©³ç´°è¨˜éŒ²ã®ã¿</option>
                </select>
                <select id="filterResponse" onchange="renderRecordList()" class="px-4 py-2 border-2 border-gray-200 rounded-xl">
                    <option value="all">å¯¾å¿œçµæœï¼šã™ã¹ã¦</option>
                    <option value="ã†ã¾ãå¯¾å¿œã§ããŸ">âœ¨ ã†ã¾ãå¯¾å¿œã§ããŸ</option>
                    <option value="ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ">ğŸ˜¢ ã†ã¾ãå¯¾å¿œã§ããªã‹ã£ãŸ</option>
                </select>
                <select id="filterTag" onchange="renderRecordList()" class="px-4 py-2 border-2 border-gray-200 rounded-xl">
                    <option value="all">ã‚¿ã‚°ï¼šã™ã¹ã¦</option>
                </select>
            </div>

            <div id="recordList" class="space-y-3">
                <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
        </section>

        <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="section-export" class="card p-8" style="display: none;">
            <h2 class="text-2xl font-bold mb-6 text-center">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h2>
            
            <!-- Gemâ‘£ã¨ã®é€£æº -->
            <div class="mb-8 p-6 rounded-2xl" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <h3 class="text-xl font-bold mb-3">ğŸ“¬ Gemâ‘£ã¨ã®é€£æº</h3>
                <p class="text-gray-700 mb-4">è¨˜éŒ²ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã€Gemâ‘£ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã€æœˆ1å›ã®è©³ç´°ãªæŒ¯ã‚Šè¿”ã‚Šã¨åˆ†æãŒã§ãã¾ã™ã€‚</p>
            </div>

            <div class="space-y-6">
                <!-- ãƒ†ã‚­ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆæ¨å¥¨ï¼‰ -->
                <div class="p-6 rounded-2xl bg-white border-2 border-purple-200">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-3xl">ğŸ“„</span>
                        <h3 class="text-xl font-bold">ãƒ†ã‚­ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆæ¨å¥¨ï¼‰</h3>
                    </div>
                    <p class="text-gray-700 mb-4">ã™ã¹ã¦ã®è¨˜éŒ²ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€‚Gemâ‘£ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦æœˆ1å›ã®æŒ¯ã‚Šè¿”ã‚Šã«ä½¿ç”¨ã—ã¾ã™ã€‚</p>
                    <button onclick="exportText()" class="btn-primary w-full">
                        ğŸ“„ ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                    </button>
                </div>

                <!-- æœŸé–“æŒ‡å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ -->
                <div class="p-6 rounded-2xl bg-white border-2 border-purple-200">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-3xl">ğŸ“…</span>
                        <h3 class="text-xl font-bold">æœŸé–“æŒ‡å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h3>
                    </div>
                    <p class="text-gray-700 mb-4">ç‰¹å®šæœŸé–“ã®è¨˜éŒ²ã®ã¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€‚æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆã«ä¾¿åˆ©ã§ã™ã€‚</p>
                    <div class="mb-4 grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-semibold mb-1">é–‹å§‹æ—¥</label>
                            <input type="date" id="exportStartDate" class="w-full px-3 py-2 border-2 border-gray-200 rounded-xl">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-1">çµ‚äº†æ—¥</label>
                            <input type="date" id="exportEndDate" class="w-full px-3 py-2 border-2 border-gray-200 rounded-xl">
                        </div>
                    </div>
                    <button onclick="exportDateRange()" class="btn-primary w-full">
                        ğŸ“… æœŸé–“ã‚’æŒ‡å®šã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                    </button>
                </div>

                <!-- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ -->
                <div class="p-6 rounded-2xl bg-white border-2 border-gray-200">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-3xl">ğŸ’¾</span>
                        <h3 class="text-xl font-bold">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ</h3>
                    </div>
                    
                    <div class="space-y-3">
                        <button onclick="showDataConfirmation()" class="w-full px-4 py-3 rounded-xl text-white font-semibold" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            ğŸ“Š ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
                        </button>
                        <button onclick="exportJSON()" class="w-full px-4 py-3 rounded-xl bg-green-500 text-white font-semibold hover:bg-green-600">
                            ğŸ’¾ JSONãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
                        </button>
                        <button onclick="importJSON()" class="w-full px-4 py-3 rounded-xl bg-blue-500 text-white font-semibold hover:bg-blue-600">
                            ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                        </button>
                        <button onclick="deleteAllRecords()" class="w-full px-4 py-3 rounded-xl bg-red-400 text-white font-semibold hover:bg-red-500">
                            ğŸ—‘ï¸ ã™ã¹ã¦å‰Šé™¤
                        </button>
                    </div>
                    
                    <div class="mt-4 p-4 bg-yellow-50 rounded-xl border-2 border-yellow-200">
                        <div class="flex items-start gap-2">
                            <span class="text-2xl">âš ï¸</span>
                            <div class="text-sm text-gray-700">
                                <strong>é‡è¦:</strong> ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢ã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤ã§è¨˜éŒ²ãŒæ¶ˆãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚å®šæœŸçš„ã«JSONãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿ç®¡ã—ã¦ãã ã•ã„ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gemâ‘£ã¨ã®é€£æºæ–¹æ³• -->
            <div class="mt-8 p-6 rounded-2xl bg-white border-2 border-blue-200">
                <div class="flex items-center gap-3 mb-3">
                    <span class="text-3xl">ğŸ“–</span>
                    <h3 class="text-xl font-bold">Gemâ‘£ã¨ã®é€£æºæ–¹æ³•</h3>
                </div>
                
                <div class="space-y-3">
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">1</div>
                        <div>
                            <strong>è¨˜éŒ²ã‚’è“„ç©ã™ã‚‹</strong>
                            <p class="text-sm text-gray-600">æ—¥ã€…ã®å‡ºæ¥äº‹ã€æ°—ã¥ãã€ã‚¿ã‚°ã‚’è¨˜éŒ²ã—ã¦ã„ãã¾ã™ã€‚</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">2</div>
                        <div>
                            <strong>æœˆ1å›ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</strong>
                            <p class="text-sm text-gray-600">ä¸Šè¨˜ã®ã€Œãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">3</div>
                        <div>
                            <strong>Gemâ‘£ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</strong>
                            <p class="text-sm text-gray-600">Gemâ‘£ã‚’é–‹ãã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€‚</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">4</div>
                        <div>
                            <strong>æŒ¯ã‚Šè¿”ã‚Šã¨åˆ†æ</strong>
                            <p class="text-sm text-gray-600">Gemâ‘£ãŒè¨˜éŒ²ã‚’åˆ†æã—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŠ½å‡ºã€é€²æ—ã®å¯è¦–åŒ–ã€æ¥æœˆã®ç›®æ¨™ã‚’ææ¡ˆã—ã¾ã™ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç¾åœ¨ã®è¨˜éŒ²çŠ¶æ³ -->
            <div class="mt-8 p-6 rounded-2xl" style="background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);">
                <div class="flex items-center gap-3 mb-4">
                    <span class="text-3xl">ğŸ“Š</span>
                    <h3 class="text-xl font-bold">ç¾åœ¨ã®è¨˜éŒ²çŠ¶æ³</h3>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <div class="text-sm text-gray-700">ç·è¨˜éŒ²æ•°</div>
                        <div class="text-4xl font-bold text-purple-600" id="export-stat-total">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-700">æœ€å¤ã®è¨˜éŒ²</div>
                        <div class="text-lg font-bold text-purple-600" id="export-stat-oldest">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-700">æœ€æ–°ã®è¨˜éŒ²</div>
                        <div class="text-lg font-bold text-purple-600" id="export-stat-newest">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-700">è¨˜éŒ²æœŸé–“</div>
                        <div class="text-lg font-bold text-purple-600" id="export-stat-days">-</div>
                    </div>
                </div>
            </div>

            <!-- éè¡¨ç¤ºã®ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ› -->
            <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleImportFile(event)">
        </section>

    </div>

    <!-- è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4" style="z-index: 1000;" onclick="closeDetailModal()">
        <div class="card max-w-2xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-2xl font-bold">ğŸ“– è¨˜éŒ²è©³ç´°</h3>
                    <button onclick="closeDetailModal()" class="text-gray-500 hover:text-gray-700 text-3xl leading-none">
                        Ã—
                    </button>
                </div>
                <div id="modalContent">
                    <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
                </div>
                <div class="mt-6 flex gap-3">
                    <button onclick="deleteCurrentRecord()" class="px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition">
                        ğŸ—‘ï¸ å‰Šé™¤
                    </button>
                    <button onclick="closeDetailModal()" class="btn-secondary">
                        é–‰ã˜ã‚‹
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let records = [];
        let currentRecordMode = 'simple';
        let currentRecordId = null;

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('recordDate').valueAsDate = new Date();
            loadRecords();
            updateDashboard();
            updateFilterTags();
        });

        // ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
        function showSection(sectionName) {
            const sections = ['record', 'list', 'dashboard', 'export'];
            sections.forEach(s => {
                document.getElementById('section-' + s).style.display = 'none';
                const btn = document.getElementById('btn-' + s);
                btn.classList.remove('active');
            });
            
            document.getElementById('section-' + sectionName).style.display = 'block';
            document.getElementById('btn-' + sectionName).classList.add('active');
            
            if (sectionName === 'list') {
                renderRecordList();
            } else if (sectionName === 'dashboard') {
                updateDashboard();
            } else if (sectionName === 'export') {
                updateExportStats();
            }
        }

        // è¨˜éŒ²ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
        function setRecordMode(mode) {
            currentRecordMode = mode;
            
            document.getElementById('mode-simple').classList.toggle('active', mode === 'simple');
            document.getElementById('mode-detailed').classList.toggle('active', mode === 'detailed');
            
            document.getElementById('simple-mode-fields').style.display = mode === 'simple' ? 'block' : 'none';
            document.getElementById('detailed-mode-fields').style.display = mode === 'detailed' ? 'block' : 'none';
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¯ãƒªã‚¢
        function clearForm() {
            document.getElementById('recordForm').reset();
            document.getElementById('recordDate').valueAsDate = new Date();
            setRecordMode('simple');
        }

        // è¨˜éŒ²ã®ä¿å­˜
        function saveRecord(event) {
            event.preventDefault();
            
            const date = document.getElementById('recordDate').value;
            let record = {
                id: Date.now(),
                date: date,
                mode: currentRecordMode,
                createdAt: new Date().toISOString()
            };
            
            if (currentRecordMode === 'simple') {
                const childMood = document.querySelector('input[name="childMood"]:checked');
                const parentCapacity = document.querySelector('input[name="parentCapacity"]:checked');
                const responseResult = document.querySelector('input[name="responseResult"]:checked');
                
                record.childMood = childMood ? childMood.value : '';
                record.parentCapacity = parentCapacity ? parentCapacity.value : '';
                record.responseResult = responseResult ? responseResult.value : '';
                
                const whatHappened = [];
                document.querySelectorAll('#simple-mode-fields .checkbox-tag input[type="checkbox"]:checked').forEach(cb => {
                    whatHappened.push(cb.value);
                });
                record.whatHappened = whatHappened;
                record.note = document.getElementById('simpleNote').value.trim();
                
            } else {
                const childMoodD = document.querySelector('input[name="childMoodDetailed"]:checked');
                const parentCapacityD = document.querySelector('input[name="parentCapacityDetailed"]:checked');
                const responseResultD = document.querySelector('input[name="responseResultDetailed"]:checked');
                
                record.childMood = childMoodD ? childMoodD.value : '';
                record.parentCapacity = parentCapacityD ? parentCapacityD.value : '';
                record.responseResult = responseResultD ? responseResultD.value : '';
                record.event = document.getElementById('detailedEvent').value.trim();
                record.insight = document.getElementById('detailedInsight').value.trim();
                
                const tags = [];
                document.querySelectorAll('#detailed-mode-fields .checkbox-tag input[type="checkbox"]:checked').forEach(cb => {
                    tags.push(cb.value);
                });
                record.tags = tags;
            }
            
            records.push(record);
            saveRecords();
            
            alert('âœ¨ è¨˜éŒ²ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            clearForm();
            updateDashboard();
            updateFilterTags();
        }

        // LocalStorageã¸ã®ä¿å­˜
        function saveRecords() {
            localStorage.setItem('dailyRecords', JSON.stringify(records));
        }

        // LocalStorageã‹ã‚‰ã®èª­ã¿è¾¼ã¿
        function loadRecords() {
            const saved = localStorage.getItem('dailyRecords');
            if (saved) {
                try {
                    records = JSON.parse(saved);
                } catch (e) {
                    console.error('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', e);
                    records = [];
                }
            }
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ›´æ–°
        function updateDashboard() {
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
            
            const stats = {
                total: records.length,
                week: records.filter(r => new Date(r.date) >= weekAgo).length,
                month: records.filter(r => new Date(r.date) >= monthStart).length,
                simple: records.filter(r => r.mode === 'simple').length,
                detailed: records.filter(r => r.mode === 'detailed').length
            };
            
            document.getElementById('stat-total').textContent = stats.total;
            document.getElementById('stat-week').textContent = stats.week;
            document.getElementById('stat-month').textContent = stats.month;
            document.getElementById('stat-simple').textContent = stats.simple;
            document.getElementById('stat-detailed').textContent = stats.detailed;
            
            renderRecentRecords();
        }

        // ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ›´æ–°
        function updateFilterTags() {
            const select = document.getElementById('filterTag');
            const allTags = new Set();
            
            records.forEach(record => {
                if (record.mode === 'simple' && record.whatHappened) {
                    record.whatHappened.forEach(tag => allTags.add(tag));
                } else if (record.mode === 'detailed' && record.tags) {
                    record.tags.forEach(tag => allTags.add(tag));
                }
            });
            
            // æ—¢å­˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ï¼ˆæœ€åˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ®‹ã™ï¼‰
            while (select.options.length > 1) {
                select.remove(1);
            }
            
            // ã‚¿ã‚°ã‚’è¿½åŠ 
            Array.from(allTags).sort().forEach(tag => {
                const option = document.createElement('option');
                option.value = tag;
                option.textContent = tag;
                select.appendChild(option);
            });
        }

        // æœ€è¿‘ã®è¨˜éŒ²ã‚’è¡¨ç¤º
        function renderRecentRecords() {
            const container = document.getElementById('recentRecords');
            const titleElement = document.getElementById('recent-title');
            
            if (records.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                titleElement.textContent = 'æœ€è¿‘ã®è¨˜éŒ²';
                return;
            }
            
            const recent = [...records].sort((a, b) => b.id - a.id).slice(0, 5);
            titleElement.textContent = `æœ€è¿‘ã®è¨˜éŒ²ï¼ˆ${recent.length}ä»¶ï¼‰`;
            
            container.innerHTML = recent.map(record => {
                const preview = record.mode === 'simple' 
                    ? (record.note || record.whatHappened?.join(', ') || 'è¨˜éŒ²ãªã—')
                    : (record.event || 'è¨˜éŒ²ãªã—');
                    
                return `
                    <div class="record-card" onclick="showDetailModal(${record.id})">
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-semibold text-lg">${record.date}</span>
                            <span class="badge ${record.mode === 'simple' ? 'badge-simple' : 'badge-detailed'}">
                                ${record.mode === 'simple' ? 'ğŸ˜Š ç°¡æ˜“' : 'ğŸ“ è©³ç´°'}
                            </span>
                        </div>
                        <p class="text-gray-600 text-sm line-clamp-2">${preview.substring(0, 50)}${preview.length > 50 ? '...' : ''}</p>
                        ${record.childMood ? `<div class="mt-2 text-sm"><span class="font-semibold">ğŸ˜Š</span> ${record.childMood} <span class="font-semibold ml-3">ğŸ’ª</span> ${record.parentCapacity}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // è¨˜éŒ²ä¸€è¦§ã®è¡¨ç¤º
        function renderRecordList() {
            const container = document.getElementById('recordList');
            const modeFilter = document.getElementById('filterMode').value;
            const responseFilter = document.getElementById('filterResponse').value;
            const tagFilter = document.getElementById('filterTag').value;
            
            let filtered = records;
            
            // ãƒ¢ãƒ¼ãƒ‰ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (modeFilter !== 'all') {
                filtered = filtered.filter(r => r.mode === modeFilter);
            }
            
            // å¯¾å¿œçµæœã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (responseFilter !== 'all') {
                filtered = filtered.filter(r => r.responseResult === responseFilter);
            }
            
            // ã‚¿ã‚°ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (tagFilter !== 'all') {
                filtered = filtered.filter(r => {
                    if (r.mode === 'simple' && r.whatHappened) {
                        return r.whatHappened.includes(tagFilter);
                    } else if (r.mode === 'detailed' && r.tags) {
                        return r.tags.includes(tagFilter);
                    }
                    return false;
                });
            }
            
            filtered.sort((a, b) => b.id - a.id);
            
            if (filtered.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">è©²å½“ã™ã‚‹è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            container.innerHTML = filtered.map(record => {
                const preview = record.mode === 'simple' 
                    ? (record.note || record.whatHappened?.join(', ') || 'è¨˜éŒ²ãªã—')
                    : (record.event || 'è¨˜éŒ²ãªã—');
                    
                return `
                    <div class="record-card" onclick="showDetailModal(${record.id})">
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-semibold text-lg">${record.date}</span>
                            <span class="badge ${record.mode === 'simple' ? 'badge-simple' : 'badge-detailed'}">
                                ${record.mode === 'simple' ? 'ğŸ˜Š ç°¡æ˜“è¨˜éŒ²' : 'ğŸ“ è©³ç´°è¨˜éŒ²'}
                            </span>
                        </div>
                        ${record.childMood ? `<div class="mb-2 text-sm"><span class="font-semibold">ğŸ˜Š</span> ${record.childMood} <span class="font-semibold ml-3">ğŸ’ª</span> ${record.parentCapacity} <span class="font-semibold ml-3">ğŸ“Œ</span> ${record.responseResult}</div>` : ''}
                        <p class="text-gray-700">${preview.substring(0, 100)}${preview.length > 100 ? '...' : ''}</p>
                    </div>
                `;
            }).join('');
        }

        // è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
        function showDetailModal(recordId) {
            const record = records.find(r => r.id === recordId);
            if (!record) return;
            
            currentRecordId = recordId;
            
            let content = `
                <div class="space-y-4">
                    <div class="flex items-center gap-3">
                        <span class="text-xl font-bold">${record.date}</span>
                        <span class="badge ${record.mode === 'simple' ? 'badge-simple' : 'badge-detailed'}">
                            ${record.mode === 'simple' ? 'ğŸ˜Š ç°¡æ˜“è¨˜éŒ²' : 'ğŸ“ è©³ç´°è¨˜éŒ²'}
                        </span>
                    </div>
                    
                    ${record.childMood ? `
                        <div class="p-4 rounded-xl bg-gradient-to-r from-blue-50 to-purple-50">
                            <div class="mb-2"><span class="font-semibold">ğŸ˜Š å­ã©ã‚‚ã®æ§˜å­:</span> ${record.childMood}</div>
                            <div class="mb-2"><span class="font-semibold">ğŸ’ª ã‚ãªãŸã®ä½™è£•:</span> ${record.parentCapacity}</div>
                            <div><span class="font-semibold">ğŸ“Œ å¯¾å¿œã®çµæœ:</span> ${record.responseResult}</div>
                        </div>
                    ` : ''}
            `;
            
            if (record.mode === 'simple') {
                if (record.whatHappened && record.whatHappened.length > 0) {
                    content += `
                        <div>
                            <h4 class="font-semibold mb-2">ğŸ” ä½•ãŒã‚ã£ãŸï¼Ÿ</h4>
                            <div class="flex flex-wrap gap-2">
                                ${record.whatHappened.map(w => `<span class="badge badge-simple">${w}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
                if (record.note) {
                    content += `
                        <div>
                            <h4 class="font-semibold mb-2">âœï¸ ä¸€è¨€ãƒ¡ãƒ¢</h4>
                            <p class="text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-xl">${record.note}</p>
                        </div>
                    `;
                }
            } else {
                if (record.event) {
                    content += `
                        <div>
                            <h4 class="font-semibold mb-2">ğŸ“ ä»Šæ—¥ã®å‡ºæ¥äº‹</h4>
                            <p class="text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-xl">${record.event}</p>
                        </div>
                    `;
                }
                if (record.insight) {
                    content += `
                        <div>
                            <h4 class="font-semibold mb-2">ğŸ’¡ æ°—ã¥ããƒ»ãƒ¡ãƒ¢</h4>
                            <p class="text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-xl">${record.insight}</p>
                        </div>
                    `;
                }
                if (record.tags && record.tags.length > 0) {
                    content += `
                        <div>
                            <h4 class="font-semibold mb-2">ğŸ·ï¸ ã‚¿ã‚°</h4>
                            <div class="flex flex-wrap gap-2">
                                ${record.tags.map(tag => `<span class="badge badge-detailed">${tag}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            content += `
                <div class="text-xs text-gray-500 mt-4">
                    è¨˜éŒ²æ—¥æ™‚: ${new Date(record.createdAt).toLocaleString('ja-JP')}
                </div>
            `;
            
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('detailModal').classList.remove('hidden');
            document.getElementById('detailModal').classList.add('flex');
        }

        // è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
            document.getElementById('detailModal').classList.remove('flex');
            currentRecordId = null;
        }

        // è¨˜éŒ²ã®å‰Šé™¤
        function deleteCurrentRecord() {
            if (!currentRecordId) return;
            if (!confirm('ã“ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
            
            records = records.filter(r => r.id !== currentRecordId);
            saveRecords();
            closeDetailModal();
            renderRecordList();
            updateDashboard();
            updateFilterTags();
            alert('ğŸ—‘ï¸ è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }

        // JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportJSON() {
            const dataStr = JSON.stringify(records, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `daily-records-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆGemâ‘£ç”¨ï¼‰
        function exportText() {
            if (records.length === 0) {
                alert('è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const sorted = [...records].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let text = '# æ—¥ã€…ã®è¨˜éŒ²ï¼ˆGemâ‘£åˆ†æç”¨ï¼‰\n\n';
            text += `æœŸé–“: ${sorted[0].date} ï½ ${sorted[sorted.length - 1].date}\n`;
            text += `ç·è¨˜éŒ²æ•°: ${records.length}ä»¶\n`;
            text += `- ç°¡æ˜“è¨˜éŒ²: ${records.filter(r => r.mode === 'simple').length}ä»¶\n`;
            text += `- è©³ç´°è¨˜éŒ²: ${records.filter(r => r.mode === 'detailed').length}ä»¶\n\n`;
            text += '=' .repeat(60) + '\n\n';
            
            sorted.forEach((record, index) => {
                text += `ã€è¨˜éŒ² ${index + 1}ã€‘ ${record.date}\n`;
                text += '-'.repeat(40) + '\n\n';
                
                // å…±é€šé …ç›®
                if (record.childMood) {
                    text += `å­ã©ã‚‚ã®æ§˜å­: ${record.childMood}\n`;
                    text += `ä¿è­·è€…ã®ä½™è£•: ${record.parentCapacity}\n`;
                    text += `å¯¾å¿œã®çµæœ: ${record.responseResult}\n\n`;
                }
                
                // ãƒ¢ãƒ¼ãƒ‰åˆ¥ã®å†…å®¹
                if (record.mode === 'simple') {
                    if (record.whatHappened && record.whatHappened.length > 0) {
                        text += `ã€ä½•ãŒã‚ã£ãŸã‹ã€‘\n`;
                        record.whatHappened.forEach(item => {
                            text += `- ${item}\n`;
                        });
                        text += '\n';
                    }
                    
                    if (record.note) {
                        text += `ã€ãƒ¡ãƒ¢ã€‘\n${record.note}\n\n`;
                    }
                } else {
                    if (record.event) {
                        text += `ã€å‡ºæ¥äº‹ã€‘\n${record.event}\n\n`;
                    }
                    
                    if (record.insight) {
                        text += `ã€æ°—ã¥ãã€‘\n${record.insight}\n\n`;
                    }
                    
                    if (record.tags && record.tags.length > 0) {
                        text += `ã€ã‚¿ã‚°ã€‘${record.tags.join(', ')}\n\n`;
                    }
                }
                
                text += '\n';
            });
            
            text += '=' .repeat(60) + '\n';
            text += `ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ—¥æ™‚: ${new Date().toLocaleString('ja-JP')}\n`;
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `è¨˜éŒ²_${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // ãƒ‡ãƒ¼ã‚¿ç¢ºèª
        function showDataConfirmation() {
            const dataSize = new Blob([JSON.stringify(records)]).size;
            const dataSizeKB = (dataSize / 1024).toFixed(2);
            
            const stats = {
                total: records.length,
                simple: records.filter(r => r.mode === 'simple').length,
                detailed: records.filter(r => r.mode === 'detailed').length
            };
            
            const message = `
ä¿å­˜ãƒ‡ãƒ¼ã‚¿æƒ…å ±:

ç·è¨˜éŒ²æ•°: ${stats.total}ä»¶
- ç°¡æ˜“è¨˜éŒ²: ${stats.simple}ä»¶
- è©³ç´°è¨˜éŒ²: ${stats.detailed}ä»¶

ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${dataSizeKB} KB

æœ€å¤ã®è¨˜éŒ²: ${records.length > 0 ? new Date(Math.min(...records.map(r => r.id))).toLocaleDateString('ja-JP') : 'ãªã—'}
æœ€æ–°ã®è¨˜éŒ²: ${records.length > 0 ? new Date(Math.max(...records.map(r => r.id))).toLocaleDateString('ja-JP') : 'ãªã—'}
            `;
            
            alert(message);
        }

        // æœŸé–“æŒ‡å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportDateRange() {
            const startDate = document.getElementById('exportStartDate').value;
            const endDate = document.getElementById('exportEndDate').value;
            
            if (!startDate || !endDate) {
                alert('é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            const filtered = records.filter(r => r.date >= startDate && r.date <= endDate);
            
            if (filtered.length === 0) {
                alert('æŒ‡å®šæœŸé–“ã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const sorted = filtered.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let text = '# æ—¥ã€…ã®è¨˜éŒ²ï¼ˆæœŸé–“æŒ‡å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼‰\n\n';
            text += `æœŸé–“: ${startDate} ï½ ${endDate}\n`;
            text += `è¨˜éŒ²æ•°: ${sorted.length}ä»¶\n`;
            text += `- ç°¡æ˜“è¨˜éŒ²: ${sorted.filter(r => r.mode === 'simple').length}ä»¶\n`;
            text += `- è©³ç´°è¨˜éŒ²: ${sorted.filter(r => r.mode === 'detailed').length}ä»¶\n\n`;
            text += '=' .repeat(60) + '\n\n';
            
            sorted.forEach((record, index) => {
                text += `ã€è¨˜éŒ² ${index + 1}ã€‘ ${record.date}\n`;
                text += '-'.repeat(40) + '\n\n';
                
                if (record.childMood) {
                    text += `å­ã©ã‚‚ã®æ§˜å­: ${record.childMood}\n`;
                    text += `ä¿è­·è€…ã®ä½™è£•: ${record.parentCapacity}\n`;
                    text += `å¯¾å¿œã®çµæœ: ${record.responseResult}\n\n`;
                }
                
                if (record.mode === 'simple') {
                    if (record.whatHappened && record.whatHappened.length > 0) {
                        text += `ã€ä½•ãŒã‚ã£ãŸã‹ã€‘\n`;
                        record.whatHappened.forEach(item => {
                            text += `- ${item}\n`;
                        });
                        text += '\n';
                    }
                    if (record.note) {
                        text += `ã€ãƒ¡ãƒ¢ã€‘\n${record.note}\n\n`;
                    }
                } else {
                    if (record.event) {
                        text += `ã€å‡ºæ¥äº‹ã€‘\n${record.event}\n\n`;
                    }
                    if (record.insight) {
                        text += `ã€æ°—ã¥ãã€‘\n${record.insight}\n\n`;
                    }
                    if (record.tags && record.tags.length > 0) {
                        text += `ã€ã‚¿ã‚°ã€‘${record.tags.join(', ')}\n\n`;
                    }
                }
                
                text += '\n';
            });
            
            text += '=' .repeat(60) + '\n';
            text += `ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ—¥æ™‚: ${new Date().toLocaleString('ja-JP')}\n`;
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `è¨˜éŒ²_${startDate}_${endDate}.txt`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // JSONã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        function importJSON() {
            document.getElementById('importFileInput').click();
        }

        function handleImportFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(imported)) {
                        alert('ä¸æ­£ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™');
                        return;
                    }
                    
                    const confirmMsg = `${imported.length}ä»¶ã®è¨˜éŒ²ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚\n\næ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã«è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã¨æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ã¾ã™ï¼‰`;
                    
                    if (confirm(confirmMsg)) {
                        // è¿½åŠ ãƒ¢ãƒ¼ãƒ‰
                        records = records.concat(imported);
                    } else {
                        // ä¸Šæ›¸ããƒ¢ãƒ¼ãƒ‰
                        records = imported;
                    }
                    
                    saveRecords();
                    updateDashboard();
                    updateFilterTags();
                    alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ');
                } catch (error) {
                    alert('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚’ãƒªã‚»ãƒƒãƒˆ
            event.target.value = '';
        }

        // ã™ã¹ã¦å‰Šé™¤
        function deleteAllRecords() {
            if (!confirm('æœ¬å½“ã«ã™ã¹ã¦ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                return;
            }
            
            if (!confirm('æœ€çµ‚ç¢ºèªï¼šã™ã¹ã¦ã®è¨˜éŒ²ãŒå®Œå…¨ã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚\nãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯å–ã‚Šã¾ã—ãŸã‹ï¼Ÿ')) {
                return;
            }
            
            records = [];
            saveRecords();
            updateDashboard();
            updateFilterTags();
            alert('ã™ã¹ã¦ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }

        // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºæ™‚ã«çµ±è¨ˆæ›´æ–°
        function updateExportStats() {
            document.getElementById('export-stat-total').textContent = records.length;
            
            if (records.length > 0) {
                const dates = records.map(r => new Date(r.date));
                const oldest = new Date(Math.min(...dates));
                const newest = new Date(Math.max(...dates));
                const days = Math.ceil((newest - oldest) / (1000 * 60 * 60 * 24)) + 1;
                
                document.getElementById('export-stat-oldest').textContent = oldest.toLocaleDateString('ja-JP');
                document.getElementById('export-stat-newest').textContent = newest.toLocaleDateString('ja-JP');
                document.getElementById('export-stat-days').textContent = days + 'æ—¥é–“';
            } else {
                document.getElementById('export-stat-oldest').textContent = '-';
                document.getElementById('export-stat-newest').textContent = '-';
                document.getElementById('export-stat-days').textContent = '-';
            }
        }
    </script>
</body>
</html>
